---
layout: post
title: "[Read Paper] MaxpoolNMS: Getting Rid of NMS Bottlenecks in Two-Stage Object Detectors"
description: "Reading note of MaxpoolNMS Getting Rid of NMS Bottlenecks in Two-Stage Object Detectors"
categories: [ReadPaper]
tags: [Detector, NMS, Maxpool]
last_updated: 2020-12-04 15:18:00 GMT+8
excerpt: "MaxpoolNMS, a parallelizable alternative to the NMS algorithm, which is based on max-pooling classification score maps."
redirect_from:
  - /2020/12/04/
---

* Kramdown table of contents
{:toc .toc}
# MaxpoolNMS: Getting Rid of NMS Bottlenecks in Two-Stage Object Detectors

MaxpoolNMS, a parallelizable alternative to the NMS algorithm, which is based on max-pooling classification score maps.

## NMS

NMS is an essential block as it removes duplicate detections, hence reducing false positives. Both the region proposal network and object detection network employ NMS as a post-processing step.

<img src="https://raw.githubusercontent.com/SingularityKChen/PicUpload/master/img/20201204150336.png" alt="System diagram of two-stage object detectors" style="zoom:33%;" />

When applied in region proposal network, it first sorts all the candidate detection boxes according to their objectness scores, followed by two nested loops to greedily select high score boxes and delete other boxes that overlap significantly with the selected ones. The inner loop is parallelizable, but **the outer loop is sequential in nature**.

<img src="https://raw.githubusercontent.com/SingularityKChen/PicUpload/master/img/20201204150738.png" alt="Execution time of convolution and GreedyNMS on different GPU platforms" style="zoom:33%;" />

## Multi-scale max-pooling

As score maps are generated by multi-scale anchors, it is natural to use multi-scale kernel sizes for different score maps when conducting max-pooling. The size of the anchor is $h \times w$.

$ksize_x, stride_x = max(1, round(\frac{\alpha w}{s}))$

$ksize_y, stride_t = max(1, round(\frac{\alpha h}{s}))$

<img src="https://raw.githubusercontent.com/SingularityKChen/PicUpload/master/img/20201204151509.png" alt="Multi-Scale Max-Pooling" style="zoom:33%;" />

## Multi-channel max-pooling

An object can produce multiple peaks on neighboring score maps.

<img src="https://raw.githubusercontent.com/SingularityKChen/PicUpload/master/img/20201204151622.png" alt="Multi-Channel Max-Pooling Across Aspect Ratios" style="zoom:33%;" />

<img src="https://raw.githubusercontent.com/SingularityKChen/PicUpload/master/img/20201204151722.png" alt="Multi-Channel Max-Pooling Across Scales" style="zoom:33%;" />